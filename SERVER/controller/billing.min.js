'use strict';"production"!==process.env.NODE_ENV&&require("dotenv").config();const stripe=require("stripe")(process.env.STRIPE_SECRET_KEY),express=require("express"),app=express(),router=express.Router(),auth=require("../config/authenticate"),User=require("../model/User");router.get("/*",(a,d,b)=>{a.app.locals.layout="index";b()});
router.post("/api/stripe",auth,(a,d)=>{stripe.charges.create({amount:500,currency:"usd",description:"Subscription for 5 Email Credits",source:a.body.id},(b,f)=>{b&&console.log(b);User.findById(a.user._id).then(c=>{c.credit+=5;c.save();then(e=>{d.status(200).json({data:e})})})})});module.exports=router;